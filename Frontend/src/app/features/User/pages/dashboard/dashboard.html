<app-sidebar></app-sidebar>
<div class="dashboard-container">
  <!-- Welcome Section -->
  <div class="welcome-section">
    <div class="welcome-content">
      <h1 class="welcome-title">{{ userGreeting }}, {{ userName }}</h1>
      <p class="welcome-subtitle">Welcome to your dashboard. Here's an overview of your vehicle services.</p>
    </div>
    <div class="welcome-actions">
      <button class="btn-primary" routerLink="/user/book-service">
        <span class="btn-icon">+</span>
        Book New Service
      </button>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <div class="stat-card" *ngFor="let stat of stats" [style.borderLeftColor]="stat.color">
      <div class="stat-icon-wrapper" [style.backgroundColor]="stat.color + '15'">
        <span class="stat-icon" [ngClass]="'icon-' + stat.icon" [style.color]="stat.color"></span>
      </div>
      <div class="stat-content">
        <div class="stat-value">{{ stat.value }}</div>
        <div class="stat-title">{{ stat.title }}</div>
        <div class="stat-change">{{ stat.change }}</div>
      </div>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="content-grid">
    <!-- Recent Appointments -->
    <div class="content-card">
      <div class="card-header">
        <h2 class="card-title">Recent Appointments</h2>
        <a routerLink="/user/recent-appointments" class="view-all-link">View All →</a>
      </div>
      <div *ngIf="isLoadingAppointments" class="loading-state">
        <p>Loading appointments...</p>
      </div>
      <div *ngIf="!isLoadingAppointments && recentAppointments.length === 0" class="empty-state">
        <p>No recent appointments found.</p>
      </div>
      <div class="appointments-list" *ngIf="!isLoadingAppointments && recentAppointments.length > 0">
        <div class="appointment-item" *ngFor="let appointment of recentAppointments">
          <div class="appointment-icon-wrapper">
            <span class="appointment-icon icon-vehicle"></span>
          </div>
          <div class="appointment-details">
            <div class="appointment-service">{{ getServiceNames(appointment) }}</div>
            <div class="appointment-vehicle">{{ appointment.vehicleName }} {{ appointment.vehicleModel }}</div>
            <div class="appointment-meta">
              <span class="appointment-date" *ngIf="appointment.appointmentDate">
                <span class="icon-calendar"></span>
                {{ formatDate(appointment.appointmentDate) }}
              </span>
              <span class="appointment-time" *ngIf="appointment.timeSlot">
                <span class="icon-clock"></span>
                {{ appointment.timeSlot }}
              </span>
            </div>
          </div>
          <div class="appointment-status">
            <span class="status-badge" [ngClass]="getStatusBadgeClass(appointment.status)">
              {{ appointment.status }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="content-card">
      <div class="card-header">
        <h2 class="card-title">Quick Actions</h2>
      </div>
      <div class="actions-grid">
        <a class="action-card" *ngFor="let action of quickActions" [routerLink]="action.route" [style.borderColor]="action.color">
          <div class="action-icon-wrapper" [style.backgroundColor]="action.color + '15'">
            <span class="action-icon" [ngClass]="'icon-' + action.icon" [style.color]="action.color"></span>
          </div>
          <div class="action-title">{{ action.title }}</div>
        </a>
      </div>
    </div>

    <!-- Upcoming Services -->
    <div class="content-card">
      <div class="card-header">
        <h2 class="card-title">Upcoming Services</h2>
      </div>
      <div class="services-list">
        <div class="service-item" *ngFor="let service of upcomingServices">
          <div class="service-icon-wrapper">
            <span class="service-icon icon-tool"></span>
          </div>
          <div class="service-details">
            <div class="service-name">{{ service.service }}</div>
            <div class="service-vehicle">{{ service.vehicle }}</div>
            <div class="service-date">
              <span class="icon-calendar"></span>
              {{ service.date }}
            </div>
          </div>
          <div class="service-days">
            <span class="days-badge">{{ service.daysLeft }} days</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Vehicle Status -->
    <div class="content-card">
      <div class="card-header">
        <h2 class="card-title">Vehicle Status</h2>
        <a routerLink="/user/my-vehicles" class="view-all-link">Manage →</a>
      </div>
      <div *ngIf="isLoadingVehicles" class="loading-state">
        <p>Loading vehicles...</p>
      </div>
      <div *ngIf="!isLoadingVehicles && vehicles.length === 0" class="empty-state">
        <p>No vehicles found. Add your first vehicle to get started.</p>
        <a routerLink="/user/my-vehicles" class="btn-link">Add Vehicle</a>
      </div>
      <div class="vehicles-list" *ngIf="!isLoadingVehicles && vehicles.length > 0">
        <div class="vehicle-item" *ngFor="let vehicle of vehicles">
          <div class="vehicle-icon-wrapper">
            <span class="vehicle-icon icon-vehicle"></span>
          </div>
          <div class="vehicle-info">
            <div class="vehicle-name">{{ vehicle.name }} {{ vehicle.model }}</div>
            <div class="vehicle-details">{{ vehicle.year }} • {{ vehicle.regNumber }} • {{ vehicle.type }}</div>
            <div class="vehicle-status">
              <span class="status-indicator"></span>
              Active
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

